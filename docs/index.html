<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Odds Ratio Calculation for GAM(M)s &amp; GLM(M)s • oddsratio</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">oddsratio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/function_tutorial.html">Function tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pat-s/oddsratio">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form" role="search" method="GET" action="search.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" id="search" name="search">
</div>
        <button type="submit" class="btn btn-default">
          <i class="glyphicon glyphicon-search"></i>
        </button>
      </form>
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="general" class="section level4">
<h4 class="hasAnchor">
<a href="#general" class="anchor"></a>General</h4>

<table style="width:93%;" class="table">
<colgroup>
<col width="19%">
<col width="27%">
<col width="22%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left">Resource:</th>
<th align="left">CRAN</th>
<th align="left">Travis CI</th>
<th align="left">Appveyor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>Platforms:</em></td>
<td align="left"><em>Multiple</em></td>
<td align="left"><em>Linux &amp; macOS</em></td>
<td align="left"><em>Windows</em></td>
</tr>
<tr class="even">
<td align="left">R CMD check</td>
<td align="left"><a href="https://cran.r-project.org/web/checks/check_results_oddsratio.html"><img border="0" src="http://www.r-pkg.org/badges/version/oddsratio" alt="CRAN version"></a></td>
<td align="left"><a href="https://travis-ci.org/pat-s/oddsratio"><img src="https://travis-ci.org/pat-s/oddsratio.svg?branch=dev" alt="Build status"></a></td>
<td align="left"><a href="https://ci.appveyor.com/project/pat-s/oddsratio"><img src="https://ci.appveyor.com/api/projects/status/p72njexjxqa9ko96/branch/dev?svg=true" alt="Build status"></a></td>
</tr>
<tr class="odd">
<td align="left">Test coverage</td>
<td align="left"></td>
<td align="left"><a href="https://codecov.io/gh/pat-s/oddsratio"><img src="https://codecov.io/gh/pat-s/oddsratio/branch/dev/graph/badge.svg" alt="Coverage Status"></a></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="cran" class="section level4">
<h4 class="hasAnchor">
<a href="#cran" class="anchor"></a>CRAN</h4>
<p><a href="https://cran.r-project.org/package=oddsratio"><img src="http://www.r-pkg.org/badges/version/oddsratio" alt="CRAN_Status_Badge"></a> <a href="https://www.r-pkg.org/pkg/oddsratio"><img src="https://cranlogs.r-pkg.org/badges/oddsratio?color=brightgreen" alt="Downloads"></a> <img src="https://cranlogs.r-pkg.org/badges/grand-total/oddsratio" alt=""></p>
<p>Functions for calculation and plotting of odds ratios of Generalized Additive (Mixed) Models and Generalized Linear (Mixed) Models with a binomial response variable (i.e. logistic regression models).</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install from CRAN:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"oddsratio"</span>)</code></pre></div>
<p>Get the development version from Github:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">remotes::<span class="kw">install_github</span>(<span class="st">"pat-s/oddsratio@dev"</span>)</code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="glm" class="section level3">
<h3 class="hasAnchor">
<a href="#glm" class="anchor"></a>GLM</h3>
<p>Odds ratio calculation of predictors <code>gre</code> &amp; <code>gpa</code> of a fitted model <code>fit_glm</code> with increment steps of 380 and 5, respectively.<br>
For factor variables (here: <code>rank</code> with 4 levels), automatically all odds ratios corresponding to the base level (here: <code>rank1</code>) are returned including their respective confident intervals. The default level is 95%. However, other levels can be specified with the param <code>CI</code>. Data source: <a href="http://www.ats.ucla.edu/stat/r/dae/logit.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/logit.htm</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pacman::<span class="kw">p_load</span>(oddsratio, mgcv)
df &lt;-<span class="st"> </span>data_glm
df$rank &lt;-<span class="st"> </span><span class="kw">factor</span>(df$rank)
fit_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(admit ~<span class="st"> </span>gre +<span class="st"> </span>gpa +<span class="st"> </span>rank, <span class="dt">data =</span> df, <span class="dt">family =</span> <span class="st">"binomial"</span>)

<span class="kw"><a href="reference/or_glm.html">or_glm</a></span>(<span class="dt">data =</span> df, <span class="dt">model =</span> fit_glm, 
       <span class="dt">incr =</span> <span class="kw">list</span>(<span class="dt">gre =</span> <span class="dv">380</span>, <span class="dt">gpa =</span> <span class="dv">5</span>, <span class="dt">CI =</span> <span class="fl">0.95</span>))</code></pre></div>
</div>
<div id="gam" class="section level3">
<h3 class="hasAnchor">
<a href="#gam" class="anchor"></a>GAM</h3>
<p>For GAMs, the calculation of odds ratio is different. Due to its non-linear definition, odds ratios do only apply to specific value changes and are not constant throughout the whole value range of the predictor as for GLMs. Hence, odds ratios of GAMs can only be computed for one predictor at a time by holding all other predictors at a fixed value while changing the value of the specific predictor. Confident intervals are currently fixed to the 95% level for GAMs. Data source: <code>?mgcv::predict.gam()</code></p>
<p>Here, the usage of <code><a href="reference/or_gam.html">or_gam()</a></code> is shown by calculating odds ratios of pred <code>x2</code> for a 20% steps across the whole value range of the predictor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
n &lt;-<span class="st"> </span><span class="dv">200</span>
sig &lt;-<span class="st"> </span><span class="dv">2</span>
df &lt;-<span class="st"> </span><span class="kw">gamSim</span>(<span class="dv">1</span>, <span class="dt">n =</span> n,<span class="dt">scale =</span> sig, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
df$x4 &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"A"</span>, <span class="dv">50</span>), <span class="kw">rep</span>(<span class="st">"B"</span>, <span class="dv">50</span>), <span class="kw">rep</span>(<span class="st">"C"</span>, <span class="dv">50</span>), <span class="kw">rep</span>(<span class="st">"D"</span>, <span class="dv">50</span>)))
fit_gam &lt;-<span class="st"> </span>mgcv::<span class="kw">gam</span>(y ~<span class="st"> </span><span class="kw">s</span>(x0) +<span class="st"> </span><span class="kw">s</span>(<span class="kw">I</span>(x1^<span class="dv">2</span>)) +<span class="st"> </span><span class="kw">s</span>(x2) +<span class="st"> </span><span class="kw">offset</span>(x3) +<span class="st"> </span>x4, <span class="dt">data =</span> df)

<span class="kw"><a href="reference/or_gam.html">or_gam</a></span>(<span class="dt">data =</span> df, <span class="dt">model =</span> fit_gam, <span class="dt">pred =</span> <span class="st">"x2"</span>,
       <span class="dt">percentage =</span> <span class="dv">20</span>, <span class="dt">slice =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If you want to compute a single odds ratio for specific values, simply set param <code>slice = FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/or_gam.html">or_gam</a></span>(<span class="dt">data =</span> df, <span class="dt">model =</span> fit_gam,
       <span class="dt">pred =</span> <span class="st">"x2"</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.099</span>, <span class="fl">0.198</span>))</code></pre></div>
<p>Plotting of GAM smooths is also supported:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/plot_gam.html">plot_gam</a></span>(fit_gam, <span class="dt">pred =</span> <span class="st">"x2"</span>, <span class="dt">title =</span> <span class="st">"Predictor 'x2'"</span>)</code></pre></div>
<p align="center">
<img src="https://raw.githubusercontent.com/pat-s/oddsratio/dev/man/figures/plot_gam.png" width="80%"></p>
<p>Insert the calculated odds ratios into the smoothing function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot_object &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_gam.html">plot_gam</a></span>(fit_gam, <span class="dt">pred =</span> <span class="st">"x2"</span>, <span class="dt">title =</span> <span class="st">"Predictor 'x2'"</span>)
or_object &lt;-<span class="st"> </span><span class="kw"><a href="reference/or_gam.html">or_gam</a></span>(<span class="dt">data =</span> df, <span class="dt">model =</span> fit_gam, 
                    <span class="dt">pred =</span> <span class="st">"x2"</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.099</span>, <span class="fl">0.198</span>))

plot &lt;-<span class="st"> </span><span class="kw"><a href="reference/insert_or.html">insert_or</a></span>(plot_object, or_object, <span class="dt">or_yloc =</span> <span class="dv">3</span>,
                  <span class="dt">values_xloc =</span> <span class="fl">0.04</span>, <span class="dt">line_size =</span> <span class="fl">0.5</span>, 
                  <span class="dt">line_type =</span> <span class="st">"dotdash"</span>, <span class="dt">values_yloc =</span> <span class="fl">0.5</span>,
                  <span class="dt">arrow_col =</span> <span class="st">"red"</span>)
plot</code></pre></div>
<p align="center">
<img src="https://raw.githubusercontent.com/pat-s/oddsratio/dev/man/figures/plot_gam2.png" width="80%"></p>
<p>Insert multiple odds ratios into one smooth:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">or_object2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/or_gam.html">or_gam</a></span>(<span class="dt">data =</span> df, <span class="dt">model =</span> fit_gam, <span class="dt">pred =</span> <span class="st">"x2"</span>, 
                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))

<span class="kw"><a href="reference/insert_or.html">insert_or</a></span>(plot, or_object2, <span class="dt">or_yloc =</span> <span class="fl">2.1</span>, <span class="dt">values_yloc =</span> <span class="dv">2</span>,
          <span class="dt">line_col =</span> <span class="st">"green4"</span>, <span class="dt">text_col =</span> <span class="st">"black"</span>,
          <span class="dt">rect_col =</span> <span class="st">"green4"</span>, <span class="dt">rect_alpha =</span> <span class="fl">0.2</span>,
          <span class="dt">line_alpha =</span> <span class="dv">1</span>, <span class="dt">line_type =</span> <span class="st">"dashed"</span>,
          <span class="dt">arrow_xloc_r =</span> <span class="fl">0.01</span>, <span class="dt">arrow_xloc_l =</span> -<span class="fl">0.01</span>,
          <span class="dt">arrow_length =</span> <span class="fl">0.01</span>, <span class="dt">rect =</span> T)   </code></pre></div>
<p align="center">
<img src="https://raw.githubusercontent.com/pat-s/oddsratio/dev/man/figures/plot_gam3.png" width="80%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=oddsratio">https://​cran.r-project.org/​package=oddsratio</a>
</li>
<li>Browse source code at <br><a href="https://github.com/pat-s/oddsratio">https://​github.com/​pat-s/​oddsratio</a>
</li>
<li>Report a bug at <br><a href="https://github.com/pat-s/oddsratio/issues">https://​github.com/​pat-s/​oddsratio/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Schratz <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://doi.org/10.5281/zenodo.807719"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.807719.svg" alt="DOI"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Patrick Schratz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
